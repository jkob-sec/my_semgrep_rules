
Findings:

  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/.github/workflows/cron_update_modules/script.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.exec-use
        Executing non-constant commands. This can lead to command injection.

         88â”† exec(sprintf(
         89â”†     'composer update prestashop/%s',
         90â”†     $moduleGit['path']
         91â”† ));


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/admin-dev/filemanager/ajax_calls.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

         71â”† file_put_contents($put_contents_path, $image_data);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-url-host
        User data flows into the host portion of this manually-constructed URL. This could allow an
        attacker to send data to their own server, potentially exposing sensitive data such as
        cookies or authorization information sent with this request. They could also probe internal
        servers or other resources that the server runnig this code can access. (This is called
        server-side request forgery, or SSRF.) Do not allow arbitrary hosts. Instead, create an
        allowlist for approved hosts hardcode the correct host.

        107â”† copy('zip://'.$path.'#'.$OnlyFileName, $base_folder.$FullFileName['name']);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/admin-dev/filemanager/dialog.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.file-inclusion
        Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote
        file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to
        sensitive files being obtained by attackers. Instead, explicitly specify what to include. If
        that is not a viable solution, validate user input thoroughly.

         81â”† require_once $current_path.$parent.'config.php';
          â‹®â”†----------------------------------------
        154â”† require_once $language_file;
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

         53â”† if (!file_exists($current_path.$subfolder.$subdir)) {
          â‹®â”†----------------------------------------
         80â”† if (file_exists($current_path.$parent.'config.php')) {
          â‹®â”†----------------------------------------
         92â”† if (!is_dir($thumbs_path.$subdir)) {
          â‹®â”†----------------------------------------
        147â”† if (is_readable('lang/'.$path_parts['basename'].'.php')) {
          â‹®â”†----------------------------------------
        411â”† } elseif (is_dir($current_path.$subfolder.$subdir.$file)) {
          â‹®â”†----------------------------------------
        412â”† $date = filemtime($current_path.$subfolder.$subdir.$file);
          â‹®â”†----------------------------------------
        418â”† $date = filemtime($file_path);
          â‹®â”†----------------------------------------
        419â”† $size = filesize($file_path);
          â‹®â”†----------------------------------------
        752â”† if (!file_exists($thumbs_path.$subdir.$file)) {
          â‹®â”†----------------------------------------
        873â”†  ... $current_path.$subfolder.$subdir.$file) || in_array($file, $hidden_files) || !in_array(mb_strtolower($file_array['extension']), $ext) || ($filter != '' && strpo ... [0m
          [shortened a long line from output, adjust with --max-chars-per-line]
          â‹®â”†----------------------------------------
        885â”† if (file_exists($file_path1)) {
          â‹®â”†----------------------------------------
        888â”† while (file_exists($current_path.$subfolder.$subdir.$info['filename'].".[".$i."].".$info['extension'])) {
          â‹®â”†----------------------------------------
        915â”† if (!file_exists($src_thumb)) {
          â‹®â”†----------------------------------------
        925â”† list($img_width, $img_height, $img_type, $attr) = getimagesize($file_path);
          â‹®â”†----------------------------------------
        942â”† if (file_exists('img/'.$icon_theme.'/'.$extension_lower.".jpg")) {


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/admin-dev/filemanager/execute.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.file-inclusion
        Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote
        file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to
        sensitive files being obtained by attackers. Instead, explicitly specify what to include. If
        that is not a viable solution, validate user input thoroughly.

         35â”† require_once $language_file;
          â‹®â”†----------------------------------------
         50â”† require_once $path.'config.php';
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

         31â”† if (is_readable('lang/'.$path_parts['basename'].'.php')) {
          â‹®â”†----------------------------------------
         49â”† if (file_exists($path.'config.php')) {
          â‹®â”†----------------------------------------
         77â”† unlink($path);
          â‹®â”†----------------------------------------
         78â”† if (file_exists($path_thumb)) {
          â‹®â”†----------------------------------------
         79â”† unlink($path_thumb);
          â‹®â”†----------------------------------------
         88â”†  ... $info['dirname'].'/'.$path.$relative_image_creation_name_to_prepend[$k].$info['filename'].$relative_image_creation_name_to_append[$k].'.'.$info['extension'])) { ... [0m
          [shortened a long line from output, adjust with --max-chars-per-line]
          â‹®â”†----------------------------------------
         89â”†  ... $info['dirname'].'/'.$path.$relative_image_creation_name_to_prepend[$k].$info['filename'].$relative_image_creation_name_to_append[$k].'.'.$info['extension']); ... [0m
          [shortened a long line from output, adjust with --max-chars-per-line]
          â‹®â”†----------------------------------------
        100â”† if (file_exists($base_dir.$fixed_image_creation_name_to_prepend[$k].$info['filename'].$fixed_image_creation_to_append[$k].'.'.$info['extension'])) {
          â‹®â”†----------------------------------------
        101â”† unlink($base_dir.$fixed_image_creation_name_to_prepend[$k].$info['filename'].$fixed_image_creation_to_append[$k].'.'.$info['extension']);
          â‹®â”†----------------------------------------
        111â”† if (is_dir($path_thumb)) {


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/admin-dev/filemanager/force_download.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

         29â”† header('Content-Length: '.(string)filesize($path.$name));
          â‹®â”†----------------------------------------
         31â”† readfile($path.$name);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/admin-dev/filemanager/upload.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.file-inclusion
        Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote
        file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to
        sensitive files being obtained by attackers. Instead, explicitly specify what to include. If
        that is not a viable solution, validate user input thoroughly.

         35â”† require_once $path.'config.php';
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

         34â”† if (file_exists($path.'config.php')) {
          â‹®â”†----------------------------------------
         57â”† if (file_exists($targetPath.$_FILES['file']['name'])) {
          â‹®â”†----------------------------------------
         60â”† while (file_exists($targetPath.$info['filename'].'_'.$i.'.'.$info['extension'])) {
          â‹®â”†----------------------------------------
         76â”† chmod($targetFile, 0755);
          â‹®â”†----------------------------------------
         85â”† $imginfo = getimagesize($targetFile);
          â‹®â”†----------------------------------------
        123â”† unlink($targetFile);
          â‹®â”†----------------------------------------
        129â”† chmod($targetFile, 0755);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/classes/ImageManager.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.exec-use
        Executing non-constant commands. This can lead to command injection.

        440â”† $mimeType = trim(exec('file -b --mime-type ' . escapeshellarg($filename)));
          â‹®â”†----------------------------------------
        442â”† $mimeType = trim(exec('file --mime ' . escapeshellarg($filename)));
          â‹®â”†----------------------------------------
        445â”† $mimeType = trim(exec('file -bi ' . escapeshellarg($filename)));


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/classes/PrestaShopAutoload.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.eval-use
        Evaluating non-constant commands. This can lead to command injection.

        133â”† return eval('class ' . $className . ' extends ' . static::$class_aliases[$className] . ' {}');
          â‹®â”†----------------------------------------
        150â”† eval($this->index[$className . 'Core']['type'] . ' ' . $className . ' extends ' . $className . 'Core {}');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/classes/Tools.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.file-inclusion
        Detected non-constant file inclusion. This can lead to local file inclusion (LFI) or remote
        file inclusion (RFI) if user input reaches this statement. LFI and RFI could lead to
        sensitive files being obtained by attackers. Instead, explicitly specify what to include. If
        that is not a viable solution, validate user input thoroughly.

        590â”† @include_once _PS_THEME_DIR_ . 'lang/' . $iso . '.php';
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

       3644â”† return @unserialize($serialized);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/classes/helper/HelperOptions.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

         66â”†  ... $_SERVER['DOCUMENT_ROOT'] . _MODULE_DIR_ . $tab['module'] . '/' . $tab['class_name'] . '.gif') ? _MODULE_DIR_ . $tab['module'] . '/' : '../img/t/') . $tab['clas ... [0m
          [shortened a long line from output, adjust with --max-chars-per-line]


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/classes/module/Module.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.eval-use
        Evaluating non-constant commands. This can lead to command injection.

       2858â”† eval(
       2859â”†     preg_replace(
       2860â”†         [
       2861â”†             '#^\s*<\?(?:php)?#',
       2862â”†             '#class\s+' . $classname . '\s+extends\s+([a-z0-9_]+)(\s+implements\s+([a-z0-9_]+))?#i',
       2863â”†         ],
       2864â”†         [
       2865â”†             ' ',
       2866â”†             'class ' . $classname . 'OverrideOriginal' . $uniq . ' extends \stdClass',
       2867â”†         ],
           [hid 3 additional lines, adjust with --max-lines-per-finding] 
       2875â”† eval(
       2876â”†     preg_replace(
       2877â”†         [
       2878â”†             '#^\s*<\?(?:php)?#',
       2879â”†             '#class\s+' . $classname . '(\s+extends\s+([a-z0-9_]+)(\s+implements\s+([a-z0-9_]+))?)?#i',
       2880â”†         ],
       2881â”†         [
       2882â”†             ' ',
       2883â”†             'class ' . $classname . 'Override' . $uniq . ' extends \stdClass',
       2884â”†         ],
           [hid 3 additional lines, adjust with --max-lines-per-finding] 
       2956â”† eval(
       2957â”†     preg_replace(
       2958â”†         [
       2959â”†             '#^\s*<\?(?:php)?#',
       2960â”†             '#class\s+' . $classname . '(\s+extends\s+([a-z0-9_]+)(\s+implements\s+([a-z0-9_]+))?)?#i',
       2961â”†         ],
       2962â”†         [
       2963â”†             ' ',
       2964â”†             'class ' . $classname . 'Override' . $uniq . ' extends \stdClass',
       2965â”†         ],
           [hid 3 additional lines, adjust with --max-lines-per-finding] 
       3082â”† eval(
       3083â”†     preg_replace(
       3084â”†         [
       3085â”†             '#^\s*<\?(?:php)?#',
       3086â”†             '#class\s+' . $classname . '\s+extends\s+([a-z0-9_]+)(\s+implements\s+([a-z0-9_]+))?#i',
       3087â”†         ],
       3088â”†         [
       3089â”†             ' ',
       3090â”†             'class ' . $classname . 'OverrideOriginal_remove' . $uniq . ' extends \stdClass',
       3091â”†         ],
           [hid 3 additional lines, adjust with --max-lines-per-finding] 
       3098â”† eval(
       3099â”†     preg_replace(
       3100â”†         [
       3101â”†             '#^\s*<\?(?:php)?#',
       3102â”†             '#class\s+' . $classname . '(\s+extends\s+([a-z0-9_]+)(\s+implements\s+([a-z0-9_]+))?)?#i',
       3103â”†         ],
       3104â”†         [
       3105â”†             ' ',
       3106â”†             'class ' . $classname . 'Override_remove' . $uniq . ' extends \stdClass',
       3107â”†         ],
           [hid 3 additional lines, adjust with --max-lines-per-finding] 
       3208â”† eval(
       3209â”†     preg_replace(
       3210â”†         [
       3211â”†             '#^\s*<\?(?:php)?#',
       3212â”†             '#class\s+' . $classname . '\s+extends\s+([a-z0-9_]+)(\s+implements\s+([a-z0-9_]+))?#i',
       3213â”†         ],
       3214â”†         [
       3215â”†             ' ',
       3216â”†             'class ' . $classname . 'OverrideOriginal_check' . $uniq . ' extends \stdClass',
       3217â”†         ],
           [hid 3 additional lines, adjust with --max-lines-per-finding] 


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/classes/webservice/WebserviceSpecificManagementImages.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.exec-use
        Executing non-constant commands. This can lead to command injection.

       1059â”† $mime_type = trim(exec('file -b --mime-type ' . escapeshellarg($file['tmp_name'])));


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/controllers/admin/AdminCustomerThreadsController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

        516â”† if (file_exists(_PS_UPLOAD_DIR_ . $_GET['filename']) && Validate::isFileName($_GET['filename'])) {
          â‹®â”†----------------------------------------
        563â”† readfile(_PS_UPLOAD_DIR_ . $filename);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/controllers/admin/AdminProductsController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-sql-string
        User data flows into this manually-constructed SQL string. User data can be safely inserted
        into SQL strings using prepared statements or an object-relational mapper (ORM). Manually-
        constructed SQL strings is a possible indicator of SQL injection, which could let an
        attacker steal or manipulate data from the database. Instead, use prepared statements
        (`$mysqli->prepare("INSERT INTO test(id, label) VALUES (?, ?)");`) or a safe library.

       3268â”†  ... 'UPDATE ' . _DB_PREFIX_ . 'image_lang SET legend = "' . pSQL($val) . '" WHERE ' . ($id_image ? 'id_image = ' . (int) $id_image : 'EXISTS (SELECT 1 FROM ' . _DB_ ... [0m
          [shortened a long line from output, adjust with --max-chars-per-line]


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/controllers/front/GetFileController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.exec-use
        Executing non-constant commands. This can lead to command injection.

        308â”† $mimeType = trim(@exec('file -b --mime-type ' . escapeshellarg($file)));
          â‹®â”†----------------------------------------
        310â”† $mimeType = trim(@exec('file --mime ' . escapeshellarg($file)));
          â‹®â”†----------------------------------------
        313â”† $mimeType = trim(@exec('file -bi ' . escapeshellarg($file)));


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/install-dev/classes/session.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

        110â”† $ref = unserialize(substr($ref, strlen('serialized_array:')));


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/js/retro-compat.js.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.tainted-filename
        File name based on user input risks server-side request forgery.

        124â”† $html .= file_get_contents($plugins[$file]['new_file']);
          â‹®â”†----------------------------------------
        131â”† $html .= file_get_contents($plugins[$file]['new_file']);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Adapter/Feature/Repository/FeatureValueRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        265â”† ->andWhere(sprintf('fv.%s = :%s', $key, $key))


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Adapter/Import/ImportEntityDeleter.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        176â”† $this->connection->executeQuery(
        177â”†     "DELETE FROM {$this->dbPrefix}category WHERE id_category NOT IN (?)",
        178â”†     [$protectedCategoriesIds],
        179â”†     [Connection::PARAM_INT_ARRAY]
        180â”† );
          â‹®â”†----------------------------------------
        182â”† $this->connection->executeQuery(
        183â”†     "DELETE FROM {$this->dbPrefix}category_lang WHERE id_category NOT IN (?)",
        184â”†     [$protectedCategoriesIds],
        185â”†     [Connection::PARAM_INT_ARRAY]
        186â”† );
          â‹®â”†----------------------------------------
        188â”† $this->connection->executeQuery(
        189â”†     "DELETE FROM {$this->dbPrefix}category_shop WHERE id_category NOT IN (?)",
        190â”†     [$protectedCategoriesIds],
        191â”†     [Connection::PARAM_INT_ARRAY]
        192â”† );
          â‹®â”†----------------------------------------
        194â”† $this->connection->executeQuery("ALTER TABLE {$this->dbPrefix}category AUTO_INCREMENT = 3");
          â‹®â”†----------------------------------------
        271â”† $this->connection->executeQuery(
        272â”†     "DELETE FROM `{$this->dbPrefix}stock_available` WHERE id_product_attribute != 0"
        273â”† );
          â‹®â”†----------------------------------------
        286â”† $this->connection->executeQuery("TRUNCATE TABLE `{$this->dbPrefix}{$table}`");
          â‹®â”†----------------------------------------
        307â”† $this->connection->executeQuery("TRUNCATE TABLE `{$this->dbPrefix}{$table}`");


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Adapter/Module/Configuration/ModuleSelfConfigurator.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        468â”† $stmt = $this->connection->prepare($sql);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Adapter/Product/Combination/Repository/CombinationRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        640â”† ->update(sprintf('%sstock_available', $this->dbPrefix), 'ps')


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Adapter/Product/Repository/ProductRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        433â”† $qb->where($qb->expr()->or(
        434â”†     $qb->expr()->like('pl.name', $dbSearchPhrase),
        435â”† 
        436â”†     // Product references
        437â”†     $qb->expr()->like('p.isbn', $dbSearchPhrase),
        438â”†     $qb->expr()->like('p.upc', $dbSearchPhrase),
        439â”†     $qb->expr()->like('p.mpn', $dbSearchPhrase),
        440â”†     $qb->expr()->like('p.reference', $dbSearchPhrase),
        441â”†     $qb->expr()->like('p.ean13', $dbSearchPhrase),
        442â”†     $qb->expr()->like('p.supplier_reference', $dbSearchPhrase),
           [hid 9 additional lines, adjust with --max-lines-per-finding] 


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Core/Domain/CustomerService/CommandHandler/UpdateCustomerThreadStatusHandler.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         63â”†         $statement = $this->connection->prepare('
         64â”†             UPDATE ' . $this->dbPrefix . 'customer_thread
         65â”†             SET status = :status
         66â”† 		    WHERE id_customer_thread = :id_customer_thread
         67â”† 		    LIMIT 1
         68â”†         ');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Core/Grid/Position/UpdateHandler/DoctrinePositionUpdateHandler.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb             ->from($this->dbPrefix . $positionDefinition->getTable(), 't')` Detected
        string concatenation with a non-literal variable in a Doctrine QueryBuilder method. This
        could lead to SQL injection if the variable is user-controlled and not properly sanitized.
        In order to prevent SQL injection, used parameterized queries or prepared statements
        instead.

         71â”† ->select('t.' . $positionDefinition->getIdField() . ', t.' . $positionDefinition->getPositionField())
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb             ->from($this->dbPrefix . $positionDefinition->getTable(), 't')
        ->select('t.' . $positionDefinition->getIdField() . ', t.' .
        $positionDefinition->getPositionField())` Detected string concatenation with a non-literal
        variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the variable
        is user-controlled and not properly sanitized. In order to prevent SQL injection, used
        parameterized queries or prepared statements instead.

         72â”† ->addOrderBy('t.' . $positionDefinition->getPositionField(), 'ASC');
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         76â”† ->andWhere('t.`' . $positionDefinition->getParentIdField() . '` = :parentId')
          â‹®â”†----------------------------------------
        109â”† ->andWhere('`' . $positionDefinition->getParentIdField() . '` = :parentId')


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Core/Grid/Query/ManufacturerQueryBuilder.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb             ->select('m.`id_manufacturer`, m.`name`, m.`active`')
        ->addSelect('COUNT(p.`id_product`) AS `products_count`')` Detected string concatenation with
        a non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection
        if the variable is user-controlled and not properly sanitized. In order to prevent SQL
        injection, used parameterized queries or prepared statements instead.

         83â”† ->addSelect('(' . $addressesQb->getSQL() . ') AS addresses_count')


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/Core/Grid/Query/Monitoring/NoQtyProductWithoutCombinationQueryBuilder.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$subQuery->select('1')             ->from($this->dbPrefix . 'stock_available', 'stock')
        ->andWhere('p.id_product = stock.id_product')` Detected string concatenation with a non-
        literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the
        variable is user-controlled and not properly sanitized. In order to prevent SQL injection,
        used parameterized queries or prepared statements instead.

         82â”† ->andWhere('NOT EXISTS(' . $attrSubQuery->getSQL() . ')')
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         90â”† $qb->andWhere('EXISTS(' . $subQuery->getSQL() . ')');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Command/UpdateSchemaCommand.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         98â”† $connection->executeQuery($sql);
          â‹®â”†----------------------------------------
        126â”† $query = $connection->executeQuery(
        127â”†     'SELECT CONSTRAINT_NAME, TABLE_NAME ' .
        128â”†     'FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS ' .
        129â”†     'WHERE CONSTRAINT_TYPE = "FOREIGN KEY" ' .
        130â”†     'AND TABLE_SCHEMA = "' . $this->dbName . '" ' .
        131â”†     'AND TABLE_NAME LIKE "' . $this->dbPrefix . '%"'
        132â”† );
          â‹®â”†----------------------------------------
        141â”† $nbQueries += $connection->executeQuery($drop);
          â‹®â”†----------------------------------------
        287â”† $query = $connection->executeQuery('SHOW FULL COLUMNS FROM ' . $tableName . ' WHERE Field="' . $fieldName . '"');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/DataCollector/HookDataCollector.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

         72â”† $this->data = is_array($data) ? $data : @unserialize($data);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/CategoryRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        123â”† $statement = $this->connection->prepare($query);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/FeatureAttributeRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        139â”† $statement = $this->connection->prepare($query);
          â‹®â”†----------------------------------------
        189â”† $statement = $this->connection->prepare($query);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/ManufacturerRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        101â”† $statement = $this->connection->prepare($query);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/OrderInvoiceRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         72â”† $statement = $this->connection->prepare($sql);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/StockManagementRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        226â”† $statement = $this->connection->prepare($query);
          â‹®â”†----------------------------------------
        267â”† $statement = $this->connection->prepare($query);
          â‹®â”†----------------------------------------
        535â”† $statement = $this->connection->prepare($query);
          â‹®â”†----------------------------------------
        557â”† $statement = $this->connection->prepare($query);
          â‹®â”†----------------------------------------
        585â”† $statement = $this->connection->prepare($query);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/StockMovementRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        246â”† $statement = $this->connection->prepare($query);
          â‹®â”†----------------------------------------
        289â”† $statement = $this->connection->prepare($query);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/StockRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        173â”† $statement = $this->connection->prepare($query);
          â‹®â”†----------------------------------------
        361â”† $statement = $this->connection->prepare($query);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/src/PrestaShopBundle/Entity/Repository/SupplierRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        101â”† $statement = $this->connection->prepare($query);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/PrestaShop.PrestaShop/tools/foreignkeyGenerator/foreign.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.exec-use
        Executing non-constant commands. This can lead to command injection.

        207â”† executeQueries(forgeChangesQueries($changes));
          â‹®â”†----------------------------------------
        210â”† executeQueries(forgeRelationsQueries($relations));
